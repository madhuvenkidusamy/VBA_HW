Sub Stocks()    Dim ticker As String    ' Dim open_price As Double        ' initialize volume at 0    ' Dim volume As Long    volume = 0        ' Keep track in the summary table    Dim Summary_Table_Row As Integer    Summary_Table_Row = 2    Range("K" & 1).Value = "close_price"    Range("J" & 1).Value = "Yearly Change ($)"    Range("I" & 1).Value = "Ticker"    Range("K" & 1).Value = " % Change"    Range("L" & 1).Value = " Total Stock Volume"        ' set starting row as a variable    startingrow = 2    lastrow = Cells(Rows.Count, 1).End(xlUp).Row        ' loop through all rows    For i = startingrow To lastrow                ' if we are still in the same ticker.... compares a cell to the next cell. if the two cells are different then...        If Cells(i + 1, 1).Value <> Cells(i, 1).Value Then                    'save ticker            ticker = Cells(i, 1).Value            ' Print ticker            Range("I" & Summary_Table_Row).Value = ticker                        ' save closing price            close_price = Cells(i, 6).Value            ' Print the closing price in the Summary Table            ' Range("K" & Summary_Table_Row).Value = close_price                        'find and print yearly change            yearly_change = close_price - open_price            Range("J" & Summary_Table_Row).Value = yearly_change                        'find and print percent change            If open_price = 0 Then                percent_change = 0            Else                percent_change = (close_price - open_price) / open_price            End If            Range("K" & Summary_Table_Row).Value = percent_change                        ' Add to the volume            volume = volume + Cells(i, 7).Value            ' Print the volume to the Summary Table            Range("L" & Summary_Table_Row).Value = volume                        ' add summary row index            Summary_Table_Row = Summary_Table_Row + 1                        ' Reset the Brand Total            volume = 0             ' if first row then...        ElseIf Cells(i - 1, 1).Value <> Cells(i, 1).Value Then            ' save open price            open_price = Cells(i, 3).Value            ' Print the open price in the Summary Table            ' Range("J" & Summary_Table_Row).Value = open_price                ' if the cell after is the same then ....        Else            volume = volume + Cells(i, 7).Value                    End If                    ' if statement for conditional formatting on yearly change column        If Cells(i, 10).Value < 0 Then            Cells(i, 10).Interior.Color = vbRed        ElseIf Cells(i, 10).Value > 0 Then            Cells(i, 10).Interior.Color = vbGreen        End If                Next i        ' format % change column to % display    Columns("K:K").Select    Selection.Style = "Percent"    Selection.NumberFormat = "0.00%"            End Sub